<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes, ScopedTypeVariables, CPP #-}</span><span></span><span>
</span><a name="line-2"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Module      :  Data.Generics.Twins</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow, CWI 2001--2004</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- License     :  BSD-style (see the LICENSE file)</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Maintainer  :  generics@haskell.org</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Portability :  non-portable (local universal quantification)</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- \&quot;Scrap your boilerplate\&quot; --- Generic programming in Haskell</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- See &lt;http://www.cs.uu.nl/wiki/GenericProgramming/SYB&gt;. The present module</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- provides support for multi-parameter traversal, which is also</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- demonstrated with generic operations like equality.</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-18"></a><span></span><span>
</span><a name="line-19"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span class="hs-operator">.</span><span class="hs-identifier">Twins</span><span> </span><span class="hs-special">(</span><span></span><span>
</span><a name="line-20"></a><span></span><span>
</span><a name="line-21"></a><span>        </span><span class="hs-comment">-- * Generic folds and maps that also accumulate</span><span>
</span><a name="line-22"></a><span>        </span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-23"></a><span>        </span><a href="Data.Generics.Twins.html#gmapAccumT"><span class="hs-identifier hs-var">gmapAccumT</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-24"></a><span>        </span><a href="Data.Generics.Twins.html#gmapAccumM"><span class="hs-identifier hs-var">gmapAccumM</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-25"></a><span>        </span><a href="Data.Generics.Twins.html#gmapAccumQl"><span class="hs-identifier hs-var">gmapAccumQl</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-26"></a><span>        </span><a href="Data.Generics.Twins.html#gmapAccumQr"><span class="hs-identifier hs-var">gmapAccumQr</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-27"></a><span>        </span><a href="Data.Generics.Twins.html#gmapAccumQ"><span class="hs-identifier hs-var">gmapAccumQ</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-28"></a><span>        </span><a href="Data.Generics.Twins.html#gmapAccumA"><span class="hs-identifier hs-var">gmapAccumA</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-29"></a><span></span><span>
</span><a name="line-30"></a><span>        </span><span class="hs-comment">-- * Mapping combinators for twin traversal</span><span>
</span><a name="line-31"></a><span>        </span><a href="Data.Generics.Twins.html#gzipWithT"><span class="hs-identifier hs-var">gzipWithT</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-32"></a><span>        </span><a href="Data.Generics.Twins.html#gzipWithM"><span class="hs-identifier hs-var">gzipWithM</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-33"></a><span>        </span><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier hs-var">gzipWithQ</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-34"></a><span></span><span>
</span><a name="line-35"></a><span>        </span><span class="hs-comment">-- * Typical twin traversals</span><span>
</span><a name="line-36"></a><span>        </span><a href="Data.Generics.Twins.html#geq"><span class="hs-identifier hs-var">geq</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-37"></a><span>        </span><a href="Data.Generics.Twins.html#gzip"><span class="hs-identifier hs-var">gzip</span></a><span class="hs-special">,</span><span></span><span>
</span><a name="line-38"></a><span>        </span><a href="Data.Generics.Twins.html#gcompare"><span class="hs-identifier hs-var">gcompare</span></a><span></span><span>
</span><a name="line-39"></a><span></span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-41"></a><span></span><span>
</span><a name="line-42"></a><span></span><span>
</span><a name="line-43"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-44"></a><span></span><span>
</span><a name="line-45"></a><span class="hs-cpp">#ifdef __HADDOCK__</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span></span><span>
</span><a name="line-47"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span><span></span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Generics.Aliases.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span class="hs-operator">.</span><span class="hs-identifier">Aliases</span></a><span></span><span>
</span><a name="line-50"></a><span></span><span>
</span><a name="line-51"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">GT</span><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-53"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-54"></a><span></span><span>
</span><a name="line-55"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 709</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Applicative</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">mappend</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mconcat</span><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-58"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-59"></a><span></span><span>
</span><a name="line-60"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-61"></a><span></span><span>
</span><a name="line-62"></a><span></span><span>
</span><a name="line-63"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-64"></a><span class="hs-comment">--</span><span>
</span><a name="line-65"></a><span class="hs-comment">--      Generic folds and maps that also accumulate</span><span>
</span><a name="line-66"></a><span class="hs-comment">--</span><span>
</span><a name="line-67"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-68"></a><span></span><span>
</span><a name="line-69"></a><span class="hs-comment">{--------------------------------------------------------------

A list map can be elaborated to perform accumulation.
In the same sense, we can elaborate generic maps over terms.

We recall the type of map:
map :: (a -&gt; b) -&gt; [a] -&gt; [b]

We recall the type of an accumulating map (see Data.List):
mapAccumL :: (a -&gt; b -&gt; (a,c)) -&gt; a -&gt; [b] -&gt; (a,[c])

Applying the same scheme we obtain an accumulating gfoldl.

--------------------------------------------------------------}</span><span></span><span>
</span><a name="line-83"></a><span></span><span>
</span><a name="line-84"></a><span class="hs-comment">-- | gfoldl with accumulation</span><span>
</span><a name="line-85"></a><span></span><span>
</span><a name="line-86"></a><span class="hs-identifier">gfoldlAccum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047769"><span class="hs-identifier hs-type">d</span></a><span></span><span>
</span><a name="line-87"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047772"><a href="#local-6989586621679047772"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679047773"><a href="#local-6989586621679047773"><span class="hs-identifier">r</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047772"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047770"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047771"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047772"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047773"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047772"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047770"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047771"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679047773"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-88"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047774"><a href="#local-6989586621679047774"><span class="hs-identifier">g</span></a></a><span class="hs-operator">.</span><span> </span><a href="#local-6989586621679047770"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047774"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047770"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047771"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679047774"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-89"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047770"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047769"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047770"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047771"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679047769"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-90"></a><span></span><span>
</span><a name="line-91"></a><a name="gfoldlAccum"><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier">gfoldlAccum</span></a></a><span> </span><a name="local-6989586621679047775"><a href="#local-6989586621679047775"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679047776"><a href="#local-6989586621679047776"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679047777"><a href="#local-6989586621679047777"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679047778"><a href="#local-6989586621679047778"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unA</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gfoldl</span><span> </span><a href="#local-6989586621679047779"><span class="hs-identifier hs-var">k'</span></a><span> </span><a href="#local-6989586621679047780"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679047778"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047777"><span class="hs-identifier hs-var">a0</span></a><span></span><span>
</span><a name="line-92"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-93"></a><span>  </span><a name="local-6989586621679047779"><a href="#local-6989586621679047779"><span class="hs-identifier">k'</span></a></a><span> </span><a name="local-6989586621679047781"><a href="#local-6989586621679047781"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679047782"><a href="#local-6989586621679047782"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679047783"><a href="#local-6989586621679047783"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047784"><a href="#local-6989586621679047784"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047785"><a href="#local-6989586621679047785"><span class="hs-identifier">c'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unA</span><span> </span><a href="#local-6989586621679047781"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679047783"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679047775"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679047784"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679047785"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679047782"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-94"></a><span>  </span><a name="local-6989586621679047780"><a href="#local-6989586621679047780"><span class="hs-identifier">z'</span></a></a><span> </span><a name="local-6989586621679047786"><a href="#local-6989586621679047786"><span class="hs-identifier">f</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679047787"><a href="#local-6989586621679047787"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047776"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679047787"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047786"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-95"></a><span></span><span>
</span><a name="line-96"></a><span></span><span>
</span><a name="line-97"></a><span class="hs-comment">-- | A type constructor for accumulation</span><span>
</span><a name="line-98"></a><span class="hs-keyword">newtype</span><span> </span><a name="A"><a href="Data.Generics.Twins.html#A"><span class="hs-identifier">A</span></a></a><span> </span><a name="local-6989586621679047737"><a href="#local-6989586621679047737"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679047738"><a href="#local-6989586621679047738"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679047739"><a href="#local-6989586621679047739"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="A"><a href="Data.Generics.Twins.html#A"><span class="hs-identifier">A</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unA"><a href="Data.Generics.Twins.html#unA"><span class="hs-identifier">unA</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047737"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047737"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047738"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679047739"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-99"></a><span></span><span>
</span><a name="line-100"></a><span></span><span>
</span><a name="line-101"></a><span class="hs-comment">-- | gmapT with accumulation</span><span>
</span><a name="line-102"></a><span class="hs-identifier">gmapAccumT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047766"><span class="hs-identifier hs-type">d</span></a><span></span><span>
</span><a name="line-103"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047768"><a href="#local-6989586621679047768"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047768"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047767"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047768"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047767"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679047768"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-104"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047767"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047766"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047767"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047766"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-105"></a><a name="gmapAccumT"><a href="Data.Generics.Twins.html#gmapAccumT"><span class="hs-identifier">gmapAccumT</span></a></a><span> </span><a name="local-6989586621679047788"><a href="#local-6989586621679047788"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679047789"><a href="#local-6989586621679047789"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679047790"><a href="#local-6989586621679047790"><span class="hs-identifier">d0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047800"><a href="#local-6989586621679047800"><span class="hs-identifier">a1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047801"><a href="#local-6989586621679047801"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a><span> </span><a href="#local-6989586621679047791"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679047792"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679047789"><span class="hs-identifier hs-var">a0</span></a><span> </span><a href="#local-6989586621679047790"><span class="hs-identifier hs-var">d0</span></a><span></span><span>
</span><a name="line-106"></a><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047800"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">unID</span><span> </span><a href="#local-6989586621679047801"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-107"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-108"></a><span>  </span><a name="local-6989586621679047791"><a href="#local-6989586621679047791"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679047793"><a href="#local-6989586621679047793"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-var">ID</span></a><span> </span><a name="local-6989586621679047794"><a href="#local-6989586621679047794"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047795"><a href="#local-6989586621679047795"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047796"><a href="#local-6989586621679047796"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679047797"><a href="#local-6989586621679047797"><span class="hs-identifier">d'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679047788"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679047793"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047795"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-109"></a><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047796"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-var">ID</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047794"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679047797"><span class="hs-identifier hs-var">d'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-110"></a><span>  </span><a name="local-6989586621679047792"><a href="#local-6989586621679047792"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679047798"><a href="#local-6989586621679047798"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679047799"><a href="#local-6989586621679047799"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047798"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-var">ID</span></a><span> </span><a href="#local-6989586621679047799"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-111"></a><span></span><span>
</span><a name="line-112"></a><span></span><span>
</span><a name="line-113"></a><span class="hs-comment">-- | Applicative version</span><span>
</span><a name="line-114"></a><span class="hs-identifier">gmapAccumA</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047762"><a href="#local-6989586621679047762"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679047763"><a href="#local-6989586621679047763"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679047764"><a href="#local-6989586621679047764"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047763"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679047764"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-115"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047765"><a href="#local-6989586621679047765"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047765"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047762"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047765"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047762"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047764"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679047765"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-116"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047762"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047763"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047762"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047764"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679047763"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-117"></a><a name="gmapAccumA"><a href="Data.Generics.Twins.html#gmapAccumA"><span class="hs-identifier">gmapAccumA</span></a></a><span> </span><a name="local-6989586621679047802"><a href="#local-6989586621679047802"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679047803"><a href="#local-6989586621679047803"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679047804"><a href="#local-6989586621679047804"><span class="hs-identifier">d0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a><span> </span><a href="#local-6989586621679047805"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679047806"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679047803"><span class="hs-identifier hs-var">a0</span></a><span> </span><a href="#local-6989586621679047804"><span class="hs-identifier hs-var">d0</span></a><span></span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-119"></a><span>      </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047807"><a href="#local-6989586621679047807"><span class="hs-identifier">d'</span></a></a><span> </span><a name="local-6989586621679047808"><a href="#local-6989586621679047808"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047807"><span class="hs-identifier hs-type">d'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span></span><span>
</span><a name="line-120"></a><span>           </span><a href="#local-6989586621679047762"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047764"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047807"><span class="hs-identifier hs-type">d'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047808"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047807"><span class="hs-identifier hs-type">d'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047762"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047764"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679047808"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-121"></a><span>      </span><a name="local-6989586621679047805"><a href="#local-6989586621679047805"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679047812"><a href="#local-6989586621679047812"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679047813"><a href="#local-6989586621679047813"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679047814"><a href="#local-6989586621679047814"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047815"><a href="#local-6989586621679047815"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679047816"><a href="#local-6989586621679047816"><span class="hs-identifier">d'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679047802"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679047812"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047814"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-122"></a><span>                    </span><a name="local-6989586621679047817"><a href="#local-6989586621679047817"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679047813"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679047816"><span class="hs-identifier hs-var">d'</span></a><span></span><span>
</span><a name="line-123"></a><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047815"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047817"><span class="hs-identifier hs-var">c'</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-124"></a><span>      </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047809"><a href="#local-6989586621679047809"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679047810"><a href="#local-6989586621679047810"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679047811"><a href="#local-6989586621679047811"><span class="hs-identifier">a'</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679047811"><span class="hs-identifier hs-type">a'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span></span><span>
</span><a name="line-125"></a><span>           </span><a href="#local-6989586621679047809"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047810"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047809"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047811"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679047810"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-126"></a><span>      </span><a name="local-6989586621679047806"><a href="#local-6989586621679047806"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679047818"><a href="#local-6989586621679047818"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679047819"><a href="#local-6989586621679047819"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047818"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679047819"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-127"></a><span></span><span>
</span><a name="line-128"></a><span></span><span>
</span><a name="line-129"></a><span class="hs-comment">-- | gmapM with accumulation</span><span>
</span><a name="line-130"></a><span class="hs-identifier">gmapAccumM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047758"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679047759"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-131"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047761"><a href="#local-6989586621679047761"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047761"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047760"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047761"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047760"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047759"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679047761"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-132"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047760"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047758"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047760"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047759"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679047758"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-133"></a><a name="gmapAccumM"><a href="Data.Generics.Twins.html#gmapAccumM"><span class="hs-identifier">gmapAccumM</span></a></a><span> </span><a name="local-6989586621679047820"><a href="#local-6989586621679047820"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a><span> </span><a href="#local-6989586621679047821"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679047822"><span class="hs-identifier hs-var">z</span></a><span></span><span>
</span><a name="line-134"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-135"></a><span>  </span><a name="local-6989586621679047821"><a href="#local-6989586621679047821"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679047823"><a href="#local-6989586621679047823"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679047824"><a href="#local-6989586621679047824"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679047825"><a href="#local-6989586621679047825"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047826"><a href="#local-6989586621679047826"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679047827"><a href="#local-6989586621679047827"><span class="hs-identifier">d'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679047820"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679047823"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047825"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-136"></a><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047826"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047827"><span class="hs-identifier hs-var">d'</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047828"><a href="#local-6989586621679047828"><span class="hs-identifier">d''</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047824"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047829"><a href="#local-6989586621679047829"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047829"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679047828"><span class="hs-identifier hs-var">d''</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-137"></a><span>  </span><a name="local-6989586621679047822"><a href="#local-6989586621679047822"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679047830"><a href="#local-6989586621679047830"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679047831"><a href="#local-6989586621679047831"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047830"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679047831"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-138"></a><span></span><span>
</span><a name="line-139"></a><span></span><span>
</span><a name="line-140"></a><span class="hs-comment">-- | gmapQl with accumulation</span><span>
</span><a name="line-141"></a><span class="hs-identifier">gmapAccumQl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047753"><span class="hs-identifier hs-type">d</span></a><span></span><span>
</span><a name="line-142"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047754"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047755"><span class="hs-identifier hs-type">r'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047754"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-143"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047754"><span class="hs-identifier hs-type">r</span></a><span></span><span>
</span><a name="line-144"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047757"><a href="#local-6989586621679047757"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047757"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047756"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047757"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047756"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679047755"><span class="hs-identifier hs-type">r'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-145"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047756"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047753"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047756"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047754"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-146"></a><a name="gmapAccumQl"><a href="Data.Generics.Twins.html#gmapAccumQl"><span class="hs-identifier">gmapAccumQl</span></a></a><span> </span><a name="local-6989586621679047832"><a href="#local-6989586621679047832"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679047833"><a href="#local-6989586621679047833"><span class="hs-identifier">r0</span></a></a><span> </span><a name="local-6989586621679047834"><a href="#local-6989586621679047834"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679047835"><a href="#local-6989586621679047835"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679047836"><a href="#local-6989586621679047836"><span class="hs-identifier">d0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047845"><a href="#local-6989586621679047845"><span class="hs-identifier">a1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047846"><a href="#local-6989586621679047846"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a><span> </span><a href="#local-6989586621679047837"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679047838"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679047835"><span class="hs-identifier hs-var">a0</span></a><span> </span><a href="#local-6989586621679047836"><span class="hs-identifier hs-var">d0</span></a><span></span><span>
</span><a name="line-147"></a><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047845"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">unCONST</span><span> </span><a href="#local-6989586621679047846"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-148"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-149"></a><span>  </span><a name="local-6989586621679047837"><a href="#local-6989586621679047837"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679047839"><a href="#local-6989586621679047839"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-var">CONST</span></a><span> </span><a name="local-6989586621679047840"><a href="#local-6989586621679047840"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047841"><a href="#local-6989586621679047841"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047842"><a href="#local-6989586621679047842"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047843"><a href="#local-6989586621679047843"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679047834"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679047839"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047841"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-150"></a><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047842"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-var">CONST</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047840"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679047832"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679047843"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-151"></a><span>  </span><a name="local-6989586621679047838"><a href="#local-6989586621679047838"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679047844"><a href="#local-6989586621679047844"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047844"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-var">CONST</span></a><span> </span><a href="#local-6989586621679047833"><span class="hs-identifier hs-var">r0</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-152"></a><span></span><span>
</span><a name="line-153"></a><span></span><span>
</span><a name="line-154"></a><span class="hs-comment">-- | gmapQr with accumulation</span><span>
</span><a name="line-155"></a><span class="hs-identifier">gmapAccumQr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047748"><span class="hs-identifier hs-type">d</span></a><span></span><span>
</span><a name="line-156"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047749"><span class="hs-identifier hs-type">r'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047750"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047750"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-157"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047750"><span class="hs-identifier hs-type">r</span></a><span></span><span>
</span><a name="line-158"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047752"><a href="#local-6989586621679047752"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047752"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047751"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047752"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679047749"><span class="hs-identifier hs-type">r'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-159"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047751"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047748"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047750"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-160"></a><a name="gmapAccumQr"><a href="Data.Generics.Twins.html#gmapAccumQr"><span class="hs-identifier">gmapAccumQr</span></a></a><span> </span><a name="local-6989586621679047847"><a href="#local-6989586621679047847"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679047848"><a href="#local-6989586621679047848"><span class="hs-identifier">r0</span></a></a><span> </span><a name="local-6989586621679047849"><a href="#local-6989586621679047849"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679047850"><a href="#local-6989586621679047850"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679047851"><a href="#local-6989586621679047851"><span class="hs-identifier">d0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047861"><a href="#local-6989586621679047861"><span class="hs-identifier">a1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047862"><a href="#local-6989586621679047862"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a><span> </span><a href="#local-6989586621679047852"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679047853"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679047850"><span class="hs-identifier hs-var">a0</span></a><span> </span><a href="#local-6989586621679047851"><span class="hs-identifier hs-var">d0</span></a><span></span><span>
</span><a name="line-161"></a><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047861"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">unQr</span><span> </span><a href="#local-6989586621679047862"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679047848"><span class="hs-identifier hs-var">r0</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-162"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-163"></a><span>  </span><a name="local-6989586621679047852"><a href="#local-6989586621679047852"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679047854"><a href="#local-6989586621679047854"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-var">Qr</span></a><span> </span><a name="local-6989586621679047855"><a href="#local-6989586621679047855"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047856"><a href="#local-6989586621679047856"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047857"><a href="#local-6989586621679047857"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679047858"><a href="#local-6989586621679047858"><span class="hs-identifier">r'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679047849"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679047854"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047856"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-164"></a><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047857"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-var">Qr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679047859"><a href="#local-6989586621679047859"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047855"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047858"><span class="hs-identifier hs-var">r'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679047847"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679047859"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-165"></a><span>  </span><a name="local-6989586621679047853"><a href="#local-6989586621679047853"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679047860"><a href="#local-6989586621679047860"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047860"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-var">Qr</span></a><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-166"></a><span></span><span>
</span><a name="line-167"></a><span></span><span>
</span><a name="line-168"></a><span class="hs-comment">-- | gmapQ with accumulation</span><span>
</span><a name="line-169"></a><span class="hs-identifier">gmapAccumQ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047744"><span class="hs-identifier hs-type">d</span></a><span></span><span>
</span><a name="line-170"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679047747"><a href="#local-6989586621679047747"><span class="hs-identifier">e</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047747"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047745"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047747"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047745"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679047746"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-171"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047745"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047744"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047745"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679047746"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-172"></a><a name="gmapAccumQ"><a href="Data.Generics.Twins.html#gmapAccumQ"><span class="hs-identifier">gmapAccumQ</span></a></a><span> </span><a name="local-6989586621679047863"><a href="#local-6989586621679047863"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Generics.Twins.html#gmapAccumQr"><span class="hs-identifier hs-var">gmapAccumQr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679047863"><span class="hs-identifier hs-var">f</span></a><span></span><span>
</span><a name="line-173"></a><span></span><span>
</span><a name="line-174"></a><span></span><span>
</span><a name="line-175"></a><span></span><span>
</span><a name="line-176"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-177"></a><span class="hs-comment">--</span><span>
</span><a name="line-178"></a><span class="hs-comment">--      Helper type constructors</span><span>
</span><a name="line-179"></a><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-181"></a><span></span><span>
</span><a name="line-182"></a><span></span><span>
</span><a name="line-183"></a><span class="hs-comment">-- | The identity type constructor needed for the definition of gmapAccumT</span><span>
</span><a name="line-184"></a><span class="hs-keyword">newtype</span><span> </span><a name="ID"><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier">ID</span></a></a><span> </span><a name="local-6989586621679047736"><a href="#local-6989586621679047736"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ID"><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier">ID</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unID"><a href="Data.Generics.Twins.html#unID"><span class="hs-identifier">unID</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047736"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-185"></a><span></span><span>
</span><a name="line-186"></a><span></span><span>
</span><a name="line-187"></a><span class="hs-comment">-- | The constant type constructor needed for the definition of gmapAccumQl</span><span>
</span><a name="line-188"></a><span class="hs-keyword">newtype</span><span> </span><a name="CONST"><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier">CONST</span></a></a><span> </span><a name="local-6989586621679047734"><a href="#local-6989586621679047734"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679047735"><a href="#local-6989586621679047735"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CONST"><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier">CONST</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unCONST"><a href="Data.Generics.Twins.html#unCONST"><span class="hs-identifier">unCONST</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047734"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-189"></a><span></span><span>
</span><a name="line-190"></a><span></span><span>
</span><a name="line-191"></a><span class="hs-comment">-- | The type constructor needed for the definition of gmapAccumQr</span><span>
</span><a name="line-192"></a><span class="hs-keyword">newtype</span><span> </span><a name="Qr"><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier">Qr</span></a></a><span> </span><a name="local-6989586621679047732"><a href="#local-6989586621679047732"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679047733"><a href="#local-6989586621679047733"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Qr"><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier">Qr</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unQr"><a href="Data.Generics.Twins.html#unQr"><span class="hs-identifier">unQr</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047732"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047732"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-193"></a><span></span><span>
</span><a name="line-194"></a><span></span><span>
</span><a name="line-195"></a><span></span><span>
</span><a name="line-196"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-comment">--      Mapping combinators for twin traversal</span><span>
</span><a name="line-199"></a><span class="hs-comment">--</span><span>
</span><a name="line-200"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-201"></a><span></span><span>
</span><a name="line-202"></a><span></span><span>
</span><a name="line-203"></a><span class="hs-comment">-- | Twin map for transformation</span><span>
</span><a name="line-204"></a><span class="hs-identifier">gzipWithT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericT"><span class="hs-identifier hs-type">GenericT</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericT"><span class="hs-identifier hs-type">GenericT</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-205"></a><a name="gzipWithT"><a href="Data.Generics.Twins.html#gzipWithT"><span class="hs-identifier">gzipWithT</span></a></a><span> </span><a name="local-6989586621679047864"><a href="#local-6989586621679047864"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679047865"><a href="#local-6989586621679047865"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679047866"><a href="#local-6989586621679047866"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Generics.Twins.html#gmapAccumT"><span class="hs-identifier hs-var">gmapAccumT</span></a><span> </span><a href="#local-6989586621679047867"><span class="hs-identifier hs-var">perkid</span></a><span> </span><a href="#local-6989586621679047868"><span class="hs-identifier hs-var">funs</span></a><span> </span><a href="#local-6989586621679047866"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-206"></a><span>                    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679048064"><a href="#local-6989586621679048064"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679048064"><span class="hs-identifier hs-var">c</span></a><span></span><span>
</span><a name="line-207"></a><span>                    </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gzipWithT&quot;</span><span></span><span>
</span><a name="line-208"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-209"></a><span>  </span><a name="local-6989586621679047867"><a href="#local-6989586621679047867"><span class="hs-identifier">perkid</span></a></a><span> </span><a name="local-6989586621679047869"><a href="#local-6989586621679047869"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679047870"><a href="#local-6989586621679047870"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679047869"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">unGT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679047869"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047870"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-210"></a><span>  </span><a name="local-6989586621679047868"><a href="#local-6989586621679047868"><span class="hs-identifier">funs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gmapQ</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679048063"><a href="#local-6989586621679048063"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047864"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679048063"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047865"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-211"></a><span></span><span>
</span><a name="line-212"></a><span></span><span>
</span><a name="line-213"></a><span></span><span>
</span><a name="line-214"></a><span class="hs-comment">-- | Twin map for monadic transformation</span><span>
</span><a name="line-215"></a><span class="hs-identifier">gzipWithM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679047743"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a><span> </span><a href="#local-6989586621679047743"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a><span> </span><a href="#local-6989586621679047743"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-216"></a><a name="gzipWithM"><a href="Data.Generics.Twins.html#gzipWithM"><span class="hs-identifier">gzipWithM</span></a></a><span> </span><a name="local-6989586621679048065"><a href="#local-6989586621679048065"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679048066"><a href="#local-6989586621679048066"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679048067"><a href="#local-6989586621679048067"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Generics.Twins.html#gmapAccumM"><span class="hs-identifier hs-var">gmapAccumM</span></a><span> </span><a href="#local-6989586621679048068"><span class="hs-identifier hs-var">perkid</span></a><span> </span><a href="#local-6989586621679048069"><span class="hs-identifier hs-var">funs</span></a><span> </span><a href="#local-6989586621679048067"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-217"></a><span>                    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679048073"><a href="#local-6989586621679048073"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679048073"><span class="hs-identifier hs-var">c</span></a><span></span><span>
</span><a name="line-218"></a><span>                    </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gzipWithM&quot;</span><span></span><span>
</span><a name="line-219"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-220"></a><span>  </span><a name="local-6989586621679048068"><a href="#local-6989586621679048068"><span class="hs-identifier">perkid</span></a></a><span> </span><a name="local-6989586621679048070"><a href="#local-6989586621679048070"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679048071"><a href="#local-6989586621679048071"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679048070"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">unGM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679048070"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679048071"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-221"></a><span>  </span><a name="local-6989586621679048069"><a href="#local-6989586621679048069"><span class="hs-identifier">funs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gmapQ</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679048072"><a href="#local-6989586621679048072"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GM"><span class="hs-identifier hs-var">GM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679048065"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679048072"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679048066"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-222"></a><span></span><span>
</span><a name="line-223"></a><span></span><span>
</span><a name="line-224"></a><span class="hs-comment">-- | Twin map for queries</span><span>
</span><a name="line-225"></a><span class="hs-identifier">gzipWithQ</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><a href="#local-6989586621679047742"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679047742"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-226"></a><a name="gzipWithQ"><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier">gzipWithQ</span></a></a><span> </span><a name="local-6989586621679048074"><a href="#local-6989586621679048074"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679048075"><a href="#local-6989586621679048075"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679048076"><a href="#local-6989586621679048076"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Generics.Twins.html#gmapAccumQ"><span class="hs-identifier hs-var">gmapAccumQ</span></a><span> </span><a href="#local-6989586621679048077"><span class="hs-identifier hs-var">perkid</span></a><span> </span><a href="#local-6989586621679048078"><span class="hs-identifier hs-var">funs</span></a><span> </span><a href="#local-6989586621679048076"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-227"></a><span>                   </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679048082"><a href="#local-6989586621679048082"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679048082"><span class="hs-identifier hs-var">r</span></a><span></span><span>
</span><a name="line-228"></a><span>                   </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gzipWithQ&quot;</span><span></span><span>
</span><a name="line-229"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-230"></a><span>  </span><a name="local-6989586621679048077"><a href="#local-6989586621679048077"><span class="hs-identifier">perkid</span></a></a><span> </span><a name="local-6989586621679048079"><a href="#local-6989586621679048079"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679048080"><a href="#local-6989586621679048080"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679048079"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">unGQ</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679048079"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679048080"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-231"></a><span>  </span><a name="local-6989586621679048078"><a href="#local-6989586621679048078"><span class="hs-identifier">funs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gmapQ</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679048081"><a href="#local-6989586621679048081"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GQ"><span class="hs-identifier hs-var">GQ</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679048074"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679048081"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679048075"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-232"></a><span></span><span>
</span><a name="line-233"></a><span></span><span>
</span><a name="line-234"></a><span></span><span>
</span><a name="line-235"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-236"></a><span class="hs-comment">--</span><span>
</span><a name="line-237"></a><span class="hs-comment">--      Typical twin traversals</span><span>
</span><a name="line-238"></a><span class="hs-comment">--</span><span>
</span><a name="line-239"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-240"></a><span></span><span>
</span><a name="line-241"></a><span class="hs-comment">-- | Generic equality: an alternative to \&quot;deriving Eq\&quot;</span><span>
</span><a name="line-242"></a><span class="hs-identifier">geq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047741"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047741"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047741"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-243"></a><span></span><span>
</span><a name="line-244"></a><span class="hs-comment">{-

Testing for equality of two terms goes like this. Firstly, we
establish the equality of the two top-level datatype
constructors. Secondly, we use a twin gmap combinator, namely tgmapQ,
to compare the two lists of immediate subterms.

(Note for the experts: the type of the worker geq' is rather general
but precision is recovered via the restrictive type of the top-level
operation geq. The imprecision of geq' is caused by the type system's
unability to express the type equivalence for the corresponding
couples of immediate subterms from the two given input terms.)

-}</span><span></span><span>
</span><a name="line-258"></a><span></span><span>
</span><a name="line-259"></a><a name="geq"><a href="Data.Generics.Twins.html#geq"><span class="hs-identifier">geq</span></a></a><span> </span><a name="local-6989586621679048083"><a href="#local-6989586621679048083"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679048084"><a href="#local-6989586621679048084"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679048085"><span class="hs-identifier hs-var">geq'</span></a><span> </span><a href="#local-6989586621679048083"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679048084"><span class="hs-identifier hs-var">y0</span></a><span></span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-identifier">geq'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-262"></a><span>    </span><a name="local-6989586621679048085"><a href="#local-6989586621679048085"><span class="hs-identifier">geq'</span></a></a><span> </span><a name="local-6989586621679048086"><a href="#local-6989586621679048086"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679048087"><a href="#local-6989586621679048087"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toConstr</span><span> </span><a href="#local-6989586621679048086"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">toConstr</span><span> </span><a href="#local-6989586621679048087"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-263"></a><span>                </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">(</span><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier hs-var">gzipWithQ</span></a><span> </span><a href="#local-6989586621679048085"><span class="hs-identifier hs-var">geq'</span></a><span> </span><a href="#local-6989586621679048086"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679048087"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-264"></a><span></span><span>
</span><a name="line-265"></a><span></span><span>
</span><a name="line-266"></a><span class="hs-comment">-- | Generic zip controlled by a function with type-specific branches</span><span>
</span><a name="line-267"></a><span class="hs-identifier">gzip</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a><span> </span><span class="hs-identifier hs-type">Maybe</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a><span> </span><span class="hs-identifier hs-type">Maybe</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-268"></a><span class="hs-comment">-- See testsuite/.../Generics/gzip.hs for an illustration</span><span>
</span><a name="line-269"></a><a name="gzip"><a href="Data.Generics.Twins.html#gzip"><span class="hs-identifier">gzip</span></a></a><span> </span><a name="local-6989586621679048088"><a href="#local-6989586621679048088"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679048089"><a href="#local-6989586621679048089"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679048090"><a href="#local-6989586621679048090"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-270"></a><span>  </span><a href="#local-6989586621679048088"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679048089"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679048090"><span class="hs-identifier hs-var">y</span></a><span></span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-special">`</span><a href="Data.Generics.Aliases.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span></span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">toConstr</span><span> </span><a href="#local-6989586621679048089"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">toConstr</span><span> </span><a href="#local-6989586621679048090"><span class="hs-identifier hs-var">y</span></a><span></span><span>
</span><a name="line-273"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="Data.Generics.Twins.html#gzipWithM"><span class="hs-identifier hs-var">gzipWithM</span></a><span> </span><span class="hs-special">(</span><a href="Data.Generics.Twins.html#gzip"><span class="hs-identifier hs-var">gzip</span></a><span> </span><a href="#local-6989586621679048088"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679048089"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679048090"><span class="hs-identifier hs-var">y</span></a><span></span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span></span><span>
</span><a name="line-275"></a><span></span><span>
</span><a name="line-276"></a><span class="hs-comment">-- | Generic comparison: an alternative to \&quot;deriving Ord\&quot;</span><span>
</span><a name="line-277"></a><span class="hs-identifier">gcompare</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679047740"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047740"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047740"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span></span><span>
</span><a name="line-278"></a><a name="gcompare"><a href="Data.Generics.Twins.html#gcompare"><span class="hs-identifier">gcompare</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679048091"><span class="hs-identifier hs-var">gcompare'</span></a><span></span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-280"></a><span>    </span><span class="hs-identifier">gcompare'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679048092"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679048093"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679048092"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679048093"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span></span><span>
</span><a name="line-281"></a><span>    </span><a name="local-6989586621679048091"><a href="#local-6989586621679048091"><span class="hs-identifier">gcompare'</span></a></a><span> </span><a name="local-6989586621679048094"><a href="#local-6989586621679048094"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679048095"><a href="#local-6989586621679048095"><span class="hs-identifier">y</span></a></a><span></span><span>
</span><a name="line-282"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679048096"><a href="#local-6989586621679048096"><span class="hs-identifier">repX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">constrRep</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toConstr</span><span> </span><a href="#local-6989586621679048094"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-283"></a><span>            </span><a name="local-6989586621679048097"><a href="#local-6989586621679048097"><span class="hs-identifier">repY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">constrRep</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toConstr</span><span> </span><a href="#local-6989586621679048095"><span class="hs-identifier hs-var">y</span></a><span></span><span>
</span><a name="line-284"></a><span>        </span><span class="hs-keyword">in</span><span></span><span>
</span><a name="line-285"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679048096"><span class="hs-identifier hs-var">repX</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679048097"><span class="hs-identifier hs-var">repY</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-286"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AlgConstr</span><span> </span><a name="local-6989586621679048098"><a href="#local-6989586621679048098"><span class="hs-identifier">nX</span></a></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier hs-var">AlgConstr</span><span> </span><a name="local-6989586621679048099"><a href="#local-6989586621679048099"><span class="hs-identifier">nY</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span></span><span>
</span><a name="line-287"></a><span>            </span><a href="#local-6989586621679048098"><span class="hs-identifier hs-var">nX</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679048099"><span class="hs-identifier hs-var">nY</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-special">(</span><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier hs-var">gzipWithQ</span></a><span> </span><a href="#local-6989586621679048091"><span class="hs-identifier hs-var">gcompare'</span></a><span> </span><a href="#local-6989586621679048094"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679048095"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-288"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IntConstr</span><span> </span><a name="local-6989586621679048100"><a href="#local-6989586621679048100"><span class="hs-identifier">iX</span></a></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier hs-var">IntConstr</span><span> </span><a name="local-6989586621679048101"><a href="#local-6989586621679048101"><span class="hs-identifier">iY</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679048100"><span class="hs-identifier hs-var">iX</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679048101"><span class="hs-identifier hs-var">iY</span></a><span></span><span>
</span><a name="line-289"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FloatConstr</span><span> </span><a name="local-6989586621679048102"><a href="#local-6989586621679048102"><span class="hs-identifier">rX</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">FloatConstr</span><span> </span><a name="local-6989586621679048103"><a href="#local-6989586621679048103"><span class="hs-identifier">rY</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679048102"><span class="hs-identifier hs-var">rX</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679048103"><span class="hs-identifier hs-var">rY</span></a><span></span><span>
</span><a name="line-290"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CharConstr</span><span> </span><a name="local-6989586621679048104"><a href="#local-6989586621679048104"><span class="hs-identifier">cX</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">CharConstr</span><span> </span><a name="local-6989586621679048105"><a href="#local-6989586621679048105"><span class="hs-identifier">cY</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679048104"><span class="hs-identifier hs-var">cX</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679048105"><span class="hs-identifier hs-var">cY</span></a><span></span><span>
</span><a name="line-291"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;type incompatibility in gcompare&quot;</span><span></span><span>
</span><a name="line-292"></a></pre></body></html>